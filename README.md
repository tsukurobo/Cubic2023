# Cubic2023

## 概要
つくばろぼっとサークルではNHK学生ロボコンに向けて統合型基板を製作しており、mainが（おそらく）NHK学生ロボコン2023において使用したバージョンです。
回路図の説明やブロック分けなどが出来ておらず、分かりにくい状態です。※修正予定

### コメント
頑張って修正します。
なお、修正時期は未定。

### Cubic2023_RP2040
#### 概要
Cubicでは以下の理由から組み込みマイコンにRP2040を採用しました。
- GPIOとPWMが多い
- cortex-M0（計算速度がそこそこ速い）
- 安価
- 書き込みが容易

システム内で3つ使い、容易に交換可能とするためにマイコンボードとして最小構成の基板を作成しました。

以下の公式リファレンスを参考に作成しました。公式リファレンスに載っている内容は説明を省略します。
https://datasheets.raspberrypi.com/rp2040/hardware-design-with-rp2040.pdf

##### RP2040
RP2040と周辺の配線です。
##### bypass condenser
マイコンの電力消費が多く動作が不安定になることがあったため、100uFのセラコンを追加しています。
##### surge protection
システム内でモータドライバと絶縁せずにRP2040を用いている箇所があるため、サージ保護としてツェナーダイオードを電源に並列に繋いでいます。
##### connector
基板サイズの制約の中でGPIOをフルに使う必要があり、1.27mmピッチのピンヘッダを採用しました。配線の最適化と差し込みの一意性を担保するために基板の3辺に沿うように配置しています。
##### indicator
基板内通信にSPIを利用しているのですが、SPI通信の状態を外部から容易に観測するためにslave側のSSに該当する箇所にLEDを付けています。以下は目視のLED状態とSSに注意したSPI通信の状況です。
|  LED  |  状況  |
| ---- | ---- |
|  点灯  |  通信異常  |
|  僅かに点灯  |  正常  |
|  点滅  |  通信速度低  |
|  消灯  |  オフライン  |

##### RESET switch
RP2040をリセットできます。接続先がMotherBoardの場合は、接続先もリセットされます。

##### microUSB
RP2040にプログラムを書き込むmicroUSBです。基本的に動作中の電源は接続先の基板から受け取るため、RP2040に書き込む以外は使用しない想定です。

##### QSPI NOR flash
プログラムが書き込まれるメモリです。

##### crystal
RP2040動作のためのcrystalです。

